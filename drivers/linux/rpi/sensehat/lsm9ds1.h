#ifndef _LSM9DS1_H_
#define _LSM9DS1_H_

enum {
	LSM9DS1_ADDRESS0 = 0x6a,
	LSM9DS1_ADDRESS1 = 0x6b,
	LSM9DS1_ID = 0x68,
};

enum {
	LSM9DS1_MAG_ADDRESS0 = 0x1c,
	LSM9DS1_MAG_ADDRESS1 = 0x1d,
	LSM9DS1_MAG_ADDRESS2 = 0x1e,
	LSM9DS1_MAG_ADDRESS3 = 0x1f,
	LSM9DS1_MAG_ID = 0x3d,
};

enum {
	LSM9DS1_ACT_THS = 0x04,
	LSM9DS1_ACT_DUR = 0x05,
	LSM9DS1_INT_GEN_CFG_XL = 0x06,
	LSM9DS1_INT_GEN_THS_X_XL = 0x07,
	LSM9DS1_INT_GEN_THS_Y_XL = 0x08,
	LSM9DS1_INT_GEN_THS_Z_XL = 0x09,
	LSM9DS1_INT_GEN_DUR_XL = 0x0A,
	LSM9DS1_REFERENCE_G = 0x0B,
	LSM9DS1_INT1_CTRL = 0x0C,
	LSM9DS1_INT2_CTRL = 0x0D,
	LSM9DS1_WHO_AM_I = 0x0F,
	LSM9DS1_CTRL1 = 0x10,
	LSM9DS1_CTRL2 = 0x11,
	LSM9DS1_CTRL3 = 0x12,
	LSM9DS1_ORIENT_CFG_G = 0x13,
	LSM9DS1_INT_GEN_SRC_G = 0x14,
	LSM9DS1_OUT_TEMP_L = 0x15,
	LSM9DS1_OUT_TEMP_H = 0x16,
	LSM9DS1_STATUS = 0x17,
	LSM9DS1_OUT_X_L_G = 0x18,
	LSM9DS1_OUT_X_H_G = 0x19,
	LSM9DS1_OUT_Y_L_G = 0x1A,
	LSM9DS1_OUT_Y_H_G = 0x1B,
	LSM9DS1_OUT_Z_L_G = 0x1C,
	LSM9DS1_OUT_Z_H_G = 0x1D,
	LSM9DS1_CTRL4 = 0x1E,
	LSM9DS1_CTRL5 = 0x1F,
	LSM9DS1_CTRL6 = 0x20,
	LSM9DS1_CTRL7 = 0x21,
	LSM9DS1_CTRL8 = 0x22,
	LSM9DS1_CTRL9 = 0x23,
	LSM9DS1_CTRL10 = 0x24,
	LSM9DS1_INT_GEN_SRC_XL = 0x26,
	LSM9DS1_STATUS2 = 0x27,
	LSM9DS1_OUT_X_L_XL = 0x28,
	LSM9DS1_OUT_X_H_XL = 0x29,
	LSM9DS1_OUT_Y_L_XL = 0x2A,
	LSM9DS1_OUT_Y_H_XL = 0x2B,
	LSM9DS1_OUT_Z_L_XL = 0x2C,
	LSM9DS1_OUT_Z_H_XL = 0x2D,
	LSM9DS1_FIFO_CTRL = 0x2E,
	LSM9DS1_FIFO_SRC = 0x2F,
	LSM9DS1_INT_GEN_CFG_G = 0x30,
	LSM9DS1_INT_GEN_THS_XH_G = 0x31,
	LSM9DS1_INT_GEN_THS_XL_G = 0x32,
	LSM9DS1_INT_GEN_THS_YH_G = 0x33,
	LSM9DS1_INT_GEN_THS_YL_G = 0x34,
	LSM9DS1_INT_GEN_THS_ZH_G = 0x35,
	LSM9DS1_INT_GEN_THS_ZL_G = 0x36,
	LSM9DS1_INT_GEN_DUR_G = 0x37,
};

enum {
	LSM9DS1_GYRO_SAMPLERATE_14_9 = 0,
	LSM9DS1_GYRO_SAMPLERATE_59_5 = 1,
	LSM9DS1_GYRO_SAMPLERATE_119 = 2,
	LSM9DS1_GYRO_SAMPLERATE_238 = 3,
	LSM9DS1_GYRO_SAMPLERATE_476 = 4,
	LSM9DS1_GYRO_SAMPLERATE_952 = 5,
};

enum {
	LSM9DS1_GYRO_BANDWIDTH_0 = 0,
	LSM9DS1_GYRO_BANDWIDTH_1 = 1,
	LSM9DS1_GYRO_BANDWIDTH_2 = 2,
	LSM9DS1_GYRO_BANDWIDTH_3 = 3,
};

enum {
	LSM9DS1_GYRO_FSR_250 = 0,
	LSM9DS1_GYRO_FSR_500 = 1,
	LSM9DS1_GYRO_FSR_2000 = 2,
};

enum {
	LSM9DS1_GYRO_HPF_0 = 0,
	LSM9DS1_GYRO_HPF_1 = 1,
	LSM9DS1_GYRO_HPF_2 = 2,
	LSM9DS1_GYRO_HPF_3 = 3,
	LSM9DS1_GYRO_HPF_4 = 4,
	LSM9DS1_GYRO_HPF_5 = 5,
	LSM9DS1_GYRO_HPF_6 = 6,
	LSM9DS1_GYRO_HPF_7 = 7,
	LSM9DS1_GYRO_HPF_8 = 8,
	LSM9DS1_GYRO_HPF_9 = 9,
};

enum {
	LSM9DS1_MAG_OFFSET_X_L = 0x05,
	LSM9DS1_MAG_OFFSET_X_H = 0x06,
	LSM9DS1_MAG_OFFSET_Y_L = 0x07,
	LSM9DS1_MAG_OFFSET_Y_H = 0x08,
	LSM9DS1_MAG_OFFSET_Z_L = 0x09,
	LSM9DS1_MAG_OFFSET_Z_H = 0x0A,
	LSM9DS1_MAG_WHO_AM_I = 0x0F,
	LSM9DS1_MAG_CTRL1 = 0x20,
	LSM9DS1_MAG_CTRL2 = 0x21,
	LSM9DS1_MAG_CTRL3 = 0x22,
	LSM9DS1_MAG_CTRL4 = 0x23,
	LSM9DS1_MAG_CTRL5 = 0x24,
	LSM9DS1_MAG_STATUS = 0x27,
	LSM9DS1_MAG_OUT_X_L = 0x28,
	LSM9DS1_MAG_OUT_X_H = 0x29,
	LSM9DS1_MAG_OUT_Y_L = 0x2A,
	LSM9DS1_MAG_OUT_Y_H = 0x2B,
	LSM9DS1_MAG_OUT_Z_L = 0x2C,
	LSM9DS1_MAG_OUT_Z_H = 0x2D,
	LSM9DS1_MAG_INT_CFG = 0x30,
	LSM9DS1_MAG_INT_SRC = 0x31,
	LSM9DS1_MAG_INT_THS_L = 0x32,
	LSM9DS1_MAG_INT_THS_H = 0x33,
};

enum {
	LSM9DS1_ACCEL_SAMPLERATE_14_9 = 1,
	LSM9DS1_ACCEL_SAMPLERATE_59_5 = 2,
	LSM9DS1_ACCEL_SAMPLERATE_119 = 3,
	LSM9DS1_ACCEL_SAMPLERATE_238 = 4,
	LSM9DS1_ACCEL_SAMPLERATE_476 = 5,
	LSM9DS1_ACCEL_SAMPLERATE_952 = 6,
};

enum {
	LSM9DS1_ACCEL_FSR_2 = 0,
	LSM9DS1_ACCEL_FSR_16 = 1,
	LSM9DS1_ACCEL_FSR_4 = 2,
	LSM9DS1_ACCEL_FSR_8 = 3,
};

enum {
	LSM9DS1_ACCEL_LPF_408 = 0,
	LSM9DS1_ACCEL_LPF_211 = 1,
	LSM9DS1_ACCEL_LPF_105 = 2,
	LSM9DS1_ACCEL_LPF_50 = 3,
};

enum {
	LSM9DS1_COMPASS_SAMPLERATE_0_625 = 0,
	LSM9DS1_COMPASS_SAMPLERATE_1_25 = 1,
	LSM9DS1_COMPASS_SAMPLERATE_2_5 = 2,
	LSM9DS1_COMPASS_SAMPLERATE_5 = 3,
	LSM9DS1_COMPASS_SAMPLERATE_10 = 4,
	LSM9DS1_COMPASS_SAMPLERATE_20 = 5,
	LSM9DS1_COMPASS_SAMPLERATE_40 = 6,
	LSM9DS1_COMPASS_SAMPLERATE_80 = 7,
};

enum {
	LSM9DS1_COMPASS_FSR_4 = 0,
	LSM9DS1_COMPASS_FSR_8 = 1,
	LSM9DS1_COMPASS_FSR_12 = 2,
	LSM9DS1_COMPASS_FSR_16 = 3,
};

typedef struct {
	int fd;
	int agaddr;
	int magaddr;

	float gs, gcs[3], gco[3];
	float as, acs[3], aco[3];
	float ms, mcs[3], mco[3];
} lsm9ds1_t;

int lsm9ds1open(lsm9ds1_t *lh, const char *dev, int addr);
void lsm9ds1close(lsm9ds1_t *lh);
int lsm9ds1read(lsm9ds1_t *lh, float gyro[3], float accel[3], float mag[3]);

#endif
